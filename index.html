<!DOCTYPE html>
<html>
<head>
	<title>Brian Gaffney &mdash; Deb.ug</title>
	<link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>
	<div id="wrapper">

		<div class="box">
			<div class="padding_wrapper">
				<h1>Brian Gaffney</h1>
				<p>Web developer and start up entrepreneur</p>
				<p><a href="mailto:brian@deb.ug">brian@deb.ug</a></p>
				<p><a href="http://au.linkedin.com/pub/brian-gaffney-brian-setkick-com-brian-deb-ug/42/60a/807">LinkedIn</a></p>
				<p><a href="http://setkick.com">Setkick.com</a> &mdash; Online pre-production for film and TV</p>
			</div>
		</div>

		<div class="box">
			<div class="padding_wrapper">
				<h2>Projects</h2>
				<p><a href="http://setkick.com">Setkick.com</a> &mdash; Online pre-production for film and TV</p>
			</div>
		</div>

		<div class="box">
			<div id="canvas"></div>
		</div>

		<div class="box double-wide">
			<div class="padding_wrapper">
				<h3> Anaconda goes here </h3>
			</div>
		</div>

	</div>




	<script type="text/javascript" src="js/masonry.min.js"></script>

	<script type="text/javascript" src="js/raphael.min.js"></script>
	<script type="text/javascript">

		window.onload = init;


	/*	  var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-32936832-1']);
		  _gaq.push(['_trackPageview']);

		  (function() {
		    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();
	*/


		function init() {
			curves.init();

			var wall = new Masonry( document.getElementById('wrapper'));
		}

		curves = {
			cs: [],
			curve_points: [],
			animation_timer: null,
			animation_duration: 2000,

			init: function() {
				// Docs on paths
				// http://www.w3.org/TR/SVG11/paths.html
				// http://raphaeljs.com/reference.html

				var paper = Raphael("canvas", 310, 310);

				var origin = [20,280];
				var end = [290,280];

				var total_curves = 22;
				var y_offset = 10;
				var curve_width = 1.2;
				var scale = 1;
				var scale_change = 0.03;

				//Get curve points
				curves.curve_points = curves.get_curve_points();

				//Draw each curve
				for (var i = 0; i < total_curves; i++) {

					path_string = 'M' + origin[0] + ',' + origin[1];
					origin[1] -= y_offset;

					path_string += 't'; //t = smooth quadratic BÃ©zier curveto

					points = curves.jitter_curve_points(curves.curve_points);

					//Each curve segment
					for(var j in points) {
						//If first time through the loop
						if(j) {
							path_string += ',';
						}

						//End point of curve segment
						end_point_x = points[j][0];
						end_point_y = points[j][1];
						path_string += end_point_x + ',' + end_point_y;
					}

					//Line to end point
					path_string += 'T' + end[0] + ',' + end[1];
					end[1] -= y_offset;

					curves.cs[i] = paper.path(path_string);
					curves.cs[i]['origin'] = origin.slice(0);
					curves.cs[i]['end'] = end.slice(0);


					curves.cs[i].attr({
						stroke: 'grey',
						'stroke-width': curve_width
					});

					//Scaling
					transform_string = 's' + scale;
					curves.cs[i].transform(transform_string);
					scale -= scale_change;

					// if(curve_width >= 0.1) {
					// 	curve_width -= 0.1;
					// }
				}



				curves.animation_timer = setInterval(function(){
					curves.animate();
				},curves.animation_duration);

			},

			animate: function() {

				//Animate
				for(var i in curves.cs) {
					c = curves.cs[i];

					points = curves.jitter_curve_points(curves.curve_points, false, true);

					path_string = 'M' + c['origin'][0] + ',' + c['origin'][1];
					path_string += 't';

					//Each curve segment
					for(var j in points) {
						//If first time through the loop
						if(j) {
							path_string += ',';
						}

						//End point of curve segment
						end_point_x = points[j][0];
						end_point_y = points[j][1];
						path_string += end_point_x + ',' + end_point_y;
					}

					path_string += 'T' + c['end'][0] + ',' + c['end'][1];

					c.animate({
						'path': path_string
					}, curves.animation_duration, 'backOut', function() {
						// Finished animating
					});
				}
			},

			//Random points for initilizing curves
			random_point: function() {
				min = -15;
				max = 5;

				return curves.rand_between(min, max);
			},

			rand_between: function(min, max) {
				return Math.floor(Math.random() * (max - min + 1)) + min;
			},

			get_curve_points: function() {
				points = [];
				var p = [];
				offset = 20;
				multiplier = 3.5;

				for (var i = 0; i < 6; i++) {
					end_point_x = (i * multiplier) + offset;
					end_point_y = curves.random_point();

					p = [end_point_x, end_point_y];
					points.push(p);
				}

				return points;
			},

			jitter_curve_points: function(curve_points, alter_x, alter_y) {

				if(alter_x) {
					console.log('alter_x');
				}

				if(alter_y) {
					console.log('alter_y');
				}

				if(!alter_x && !alter_x) {
					return curve_points;
				}

				var tmp_curve_points = [];
				for(var i in curve_points) {
					tmp_curve_points[i] = [];

					if(alter_x) {
						tmp_curve_points[i][0] = curve_points[i][0] + curves.rand_between(-3,3);
					} else {
						tmp_curve_points[i][0] = curve_points[i][0];
					}

					if(alter_y) {
						tmp_curve_points[i][1] = curve_points[i][1] + curves.rand_between(-3,3);
					} else {
						tmp_curve_points[i][1] = curve_points[i][1];
					}
				}

				return tmp_curve_points;
			}

		}
		</script>




</body>
</html>